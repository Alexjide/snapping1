<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>이미지 소환 및 다시 시작하기</title>
    <style>
        .controlPanel {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: rgba(255, 255, 255, 0.5);
            padding: 10px;
            z-index: 1; /* 이미지 위에 나타나도록 */
        }

        .controlPanel input[type="range"],
        .controlPanel button {
            pointer-events: none; /* 박스 안에 있는 요소의 클릭/터치 이벤트 차단 */
        }

        .movableImage {
            position: absolute;
            transition: transform 0.5s ease-in-out;
        }
    </style>
</head>
<body>

<div class="controlPanel">
    <label for="speedControl">이동 속도 (기준):</label>
    <input type="range" id="speedControl" min="0.1" max="2" step="0.1" value="0.3"><br>
    <label for="sizeControl">이미지 크기 (%):</label>
    <input type="range" id="sizeControl" min="10" max="100" step="1" value="15"><br>
    <button id="summonButton">소환</button>
    <button id="resetButton">다시 시작하기</button><br>
</div>

<input type="file" id="imageInput" accept="image/*">

<script>
    let imageSrc = null;

    document.getElementById('imageInput').addEventListener('change', function(event) {
        if (event.target.files && event.target.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                imageSrc = e.target.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        }
    });

    document.getElementById('summonButton').addEventListener('click', function(event) {
        if (imageSrc) {
            const img = document.createElement('img');
            img.src = imageSrc;
            img.classList.add('movableImage');
            document.body.appendChild(img);
            adjustImageSizeAndPosition(img, true);
        }
    });

    document.getElementById('resetButton').addEventListener('click', function(event) {
        const images = document.querySelectorAll('.movableImage');
        images.forEach(img => img.remove());
    });

    document.addEventListener('click', function(event) {
        const x = event.clientX || event.touches[0].clientX;
        const y = event.clientY || event.touches[0].clientY;

        const images = document.querySelectorAll('.movableImage'); // 모든 이미지 선택

        images.forEach((img, index) => {
            moveImageTowards(img, x, y, index);
        });
    });

    function moveImageTowards(img, x, y, index) {
        const speedAdjustment = Math.random() * 0.6 - 0.3;
        const speed = 2 - parseFloat(document.getElementById('speedControl').value) + speedAdjustment;

        img.style.transition = `transform ${speed}s ease-in-out`;

        const offsetX = Math.random() * 1000 - 10;
        const offsetY = Math.random() * 1000 - 10;

        img.style.transform = `translate(${x + offsetX}px, ${y + offsetY}px)`;
    }

    document.getElementById('speedControl').addEventListener('input', function() {
        const newSpeed = parseFloat(this.value);
        const images = document.querySelectorAll('.movableImage');
        images.forEach(img => {
            img.style.transitionDuration = `${newSpeed}s`;
        });
    });

    document.getElementById('sizeControl').addEventListener('input', function() {
        const sizePercentage = this.value;
        const images = document.querySelectorAll('.movableImage');
        images.forEach(img => {
            img.style.width = `${sizePercentage}%`;
        });
    });

    function adjustImageSizeAndPosition(img, withOffset = false) {
        const sizePercentage = document.getElementById('sizeControl').value;
        img.style.width = `${sizePercentage}%`;

        if (withOffset) {
            const offsetX = Math.random() * 1000 - 10;
            const offsetY = Math.random() * 1000 - 10;
            img.style.transform = `translate(${offsetX}px, ${offsetY}px)`;
        }
    }
</script>

</body>
</html>
